109-1 資料科學應用 exam1
班級:經濟四乙
學號:A106260018
姓名:張鈞茹

> #1. 小吳老師於某系教授 A, B 兩班學生微積分，學期各次成績紀錄於 Calculus-score-A.csv 及Calculus-score-B.xls 兩檔案。
> #檔案中紀錄 4 次小考成績、期中期末成績、助教 (TA) 成績，各次考試之配分比例及學期點名出席次數。
> #(a) 讀入兩資料檔，並印出兩資料的前、後各 5 筆紀錄。
> 
> data1 <- read.csv("Calculus-score-A.csv",skip=2)
> names(data1)[5:12] <- c("T1","T2","T3","T4","TA","ME","FE","AT")
> head(data1,5)
  座號      學號   姓名 性別 T1 T2 T3 T4   TA ME FE AT
1    1 401405008 希瑄彥   男 10  0  5 20  0.0 55 50  2
2    2 401550880 張泓丞   男 25 40 70 87 80.0 46 68  9
3    3 404550061 張安婕   女 18 15 48 33 86.7 54 79  9
4    4 404550042 柯政學   男 10 10 NA NA 13.3  2  0  7
5    5 404550023 謝文躍   女 35 45 52 97 86.7 55 67  9
> tail(data1,5)
   座號      學號   姓名 性別 T1  T2 T3  T4    TA ME  FE AT
36   36 404550369 陳王霖   女 55  73 92  73 100.0 72  81  9
37   37 404550420 何瑄穎   男 28  10 35   3  66.7 30   0  7
38   38 404550431 沈泓霏   女 15  25 53  67  93.3 29  42  9
39   39 404550442 許安霏   女 53  60 80  72 100.0 61  62  9
40   40 404550453 李政宜   男 80 100 85 100 100.0 95 100  3
> 
> library(readxl)
> data2 <- read_xls("Calculus-score-B.xls",skip=2)
New names:
* `0.070000000000000007` -> `0.070000000000000007...5`
* `0.070000000000000007` -> `0.070000000000000007...6`
* `0.080000000000000002` -> `0.080000000000000002...7`
* `0.080000000000000002` -> `0.080000000000000002...8`
> names(data2)[5:12] <- c("T1","T2","T3","T4","TA","ME","FE","AT")
> tail(data2,5)
# A tibble: 5 x 12
   座號      學號 姓名   性別     T1    T2    T3    T4    TA    ME    FE    AT
  <dbl>     <dbl> <chr>  <chr> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
1    51 404685407 鄭鈺尤 女       80    85   100    85   100    89    95     9
2    52 404685905 楊宜路 男       48    35    48    98   100    50    62     9
3    53 404685013 張渝妤 男        0    38    60    40    87    49    25     1
4    54 404685119 廖暄安 男       50    70    20    85   100    54    69     4
5    55 499555916 楊毅亦 女        5    35    45    55    87    58    60     3
> 
> #(b) 將上述之兩資料合併為㇐個資料框 data.frame (命名為 score)，使得各欄位名稱如下所示並增加㇐欄位註明班別 (Class)。
> #(提示: rbind)
> #score[38:43]
> #     No       ID   Name Gender Quiz1 Quiz2 Quiz3 Quiz4     TA Midterm Final ATT Class
> # 38 38 404550431 沈泓霏     女    15    25    53    67   93.3      29    42   9     A
> # 39 39 404550442 許安霏     女    53    60    80    72  100.0      61    62   9     A
> # 40 40 404550453 李政宜     男    80   100    85   100  100.0      95   100   3     A
> # 41  1 404550465 史文羽     男    60    81   100    97  100.0      90    83   6     B
> # 42  2 404685071 鄭樺妤     男    80   100   100    92  100.0      92    97   2     B
> # 43  3 404685084 張敬安     男    10    40    62    93  100.0      65    84   9     B
> data1.1 <- cbind(data1,Class = rep("A"))
> data2.1 <- cbind(data2,Class = rep("B"))
> score <- rbind(data1.1,data2.1)
> score
   座號      學號   姓名 性別 T1  T2  T3  T4    TA ME  FE AT Class
1     1 401405008 希瑄彥   男 10   0   5  20   0.0 55  50  2     A
2     2 401550880 張泓丞   男 25  40  70  87  80.0 46  68  9     A
3     3 404550061 張安婕   女 18  15  48  33  86.7 54  79  9     A
4     4 404550042 柯政學   男 10  10  NA  NA  13.3  2   0  7     A
5     5 404550023 謝文躍   女 35  45  52  97  86.7 55  67  9     A
6     6 404550000 張樺玫   男 30  35  90  67  86.7 54  48  9     A
7     7 404550057 徐  敬   女 12  10  38   3  80.0 32  17  9     A
8     8 404550075 王亞詠   女 30  45  85  65  93.3 60  77  9     A
9     9 404550013 王承庭   男 30  15  72  37  86.7 27  33  7     A
10   10 404550001 高羽黛   女 25  10  50  NA  46.7 24   0  1     A
11   11 404550189 丁易偉   女 80 100 100  93  93.3 90  93  4     A
12   12 404550177 彥氏丞   男 40  20  55  38  86.7 71  53  9     A
13   13 404550155 婕　學   女  0  10  40  NA  60.0  5   0  2     A
14   14 404550143 躍庭祐   女  9   0  50  30  60.0  0   0  6     A
15   15 404550161 玫鈞霖   男 25  30  85  53 100.0 54  72  9     A
16   16 404550149 家聿穎   女 47  60  70  82 100.0 61  75  7     A
17   17 404550126 詠吾筑   男  3   5  NA  NA  40.0  8   0  0     A
18   18 404550294 庭馨儀   女  5   0  30  NA  93.3 18   0  3     A
19   19 404550272 黛婕西   女 20  13  60  43  86.7 43  62  9     A
20   20 404550250 偉茹麥   男  2  20  50  65  80.0 42  77  5     A
21   21 404550238 氏存水   女  0  23  30   7  93.3 45  37  9     A
22   22 404550216 家芳榮   女 50  28  80  97 100.0 35  54  9     A
23   23 404550294 嫣玲杰   女  0   0  NA  NA  53.3  0   0  3     A
24   24 404550272 美慈蒙   女 13  48  73  65  93.3 45  65  7     A
25   25 404550250 鈺玲豪   男 55  25  65  60 100.0  8  88  9     A
26   26 404550215 宜  慈   男 40  58  65  30 100.0 21  85  9     A
27   27 404550287 柯陳渝   男  0  45  53  40  93.3 37  76  9     A
28   28 404550361 紀鍾暄   男 50  50  90  68 100.0 50  93  9     A
29   29 404550340 蔡鍾毅   男 35  15  82  28 100.0 34  71  9     A
30   30 404550328 梅林茹   男 25  65  62  41 100.0 82  65  9     A
31   31 404550386 王柯辰   女 45  53  77  57 100.0 51  70  9     A
32   32 404550360 曾紀崴   女 45  55  83  64 100.0 52  47  9     A
33   33 404550344 呂蔡嘉   男 30  40  90  78 100.0 22  88  7     A
34   34 404550322 廖繆傑   男 30  35 100  82 100.0 51  88  9     A
35   35 404550328 李梅祐   男 20  25  55  32  86.7 41  48  7     A
36   36 404550369 陳王霖   女 55  73  92  73 100.0 72  81  9     A
37   37 404550420 何瑄穎   男 28  10  35   3  66.7 30   0  7     A
38   38 404550431 沈泓霏   女 15  25  53  67  93.3 29  42  9     A
39   39 404550442 許安霏   女 53  60  80  72 100.0 61  62  9     A
40   40 404550453 李政宜   男 80 100  85 100 100.0 95 100  3     A
41    1 404550465 史文羽   男 60  81 100  97 100.0 90  83  6     B
42    2 404685071 鄭樺妤   男 80 100 100  92 100.0 92  97  2     B
43    3 404685084 張敬安   男 10  40  62  93 100.0 65  84  9     B
44    4 404685099 何筑亦   女 15  25  40  13  93.3 36   5  9     B
45    5 404685100 張  儀   女 30  45  70  61  93.3 29  48  4     B
46    6 401550816 雷西萱   男 75  78  67  58  93.3 35  33  9     B
47    7 401555528 張麥笙   女 60  33  15  65  87.0 65  47  5     B
48    8 403555042 張水兆   男  0  30  50  80  13.0 NA  90  9     B
49    9 404720052 柯榮品   男  0   0   5  NA  73.0  5  NA  9     B
50   10 404720063 謝卡欣   男 30  25  30  10  60.0 21  38  4     B
51   11 404720074 張莉儷   男 25  10  10  15  73.0 13  15  9     B
52   12 404720005 王恭莞   女 53  25  80  85  80.0 73  63  9     B
53   13 404720016 王琇易   男 15   5  15  90  87.0  3  52  9     B
54   14 404720027 高凱瓊   男 15  40  35  60  80.0 42  32  9     B
55   15 404720038 丁乃愛   男 55  70  85  80 100.0 49  45  7     B
56   16 404720049 張瑞書   女 20  28  10  70  80.0 36  22  6     B
57   17 404720150 曾銘清   男 65  63  15  50  80.0 57  55  4     B
58   18 404720161 劉莞韋   男 95  86  85  75 100.0 80  82  9     B
59   19 404720172 曾易佳   男 80  65  98  75  80.0 64  80  2     B
60   20 404720184 黃瓊品   男 15   0   5   0  73.0  7  16  5     B
61   21 404720195 廖愛靜   男 30  30  20  20  80.0 14  24  9     B
62   22 404720106 詹書飛   男 65  80  80  85 100.0 63  65  7     B
63   23 404720117 劉徐卉   男 65  90  70  65 100.0 68  64  0     B
64   24 404720211 許怡怡   男 30  10  20  20  67.0 12  NA  3     B
65   25 404720427 鄭  芊   男 30   5  10  65 100.0 35  20  9     B
66   26 404720526 楊亞易   女 25  NA  NA  NA  67.0  0   0  9     B
67   27 404720624 張羽廖   男 45   0  30  65  73.0 55  57  9     B
68   28 404720722 楊佳聿   女 30  35  20  50  60.0 45  63  9     B
69   29 404720429 吾靜宜   男 55  20   5  15  73.0 44  30  3     B
70   30 404720527 馨飛羽   男 15   0  45  65  93.0 44  44  7     B
71   31 404720625 婕曾卉   男 10   0   0  66  67.0  5   0  9     B
72   32 404720723 茹呂怡   男 35  50  30  90 100.0 56  55  9     B
73   33 404720821 存廖芊   男 20  15  10  55  80.0 28  46  9     B
74   34 404720929 芳李米   男 35  15  40  65 100.0 48  50  9     B
75   35 404720037 勳  陳   男 20  30  22  60  80.0 50  38  9     B
76   36 404720135 萱何兆   男 35  25  85  55 100.0 58  70  9     B
 [ reached 'max' / getOption("max.print") -- omitted 19 rows ]
> 
> #(c) 依各項考試 (小考、期中期末) 配分算出每位同學之學期成績 (缺考以零分計)。
> #其中「出席成績」為額外加分，出席幾次，則總分加幾分。總分以不超過 100 為原則。請列出全班學期成績。
> score$total <- score[, 5:11]
> library(Hmisc)
> score.1 <- impute(score$total, 0)
> Semester_grades <- as.matrix(score.1) %*% as.vector(c(0.07, 0.07, 0.08, 0.08,0.15, 0.25, 0.3))
> 學期成績 <-ifelse(Semester_grades + score$AT>100,100,Semester_grades + score$AT)
> Score <- data.frame(score$座號, score$學號, score$姓名, score$性別, score$Class,學期成績)
> Score
   score.座號 score.學號 score.姓名 score.性別 score.Class 學期成績
1           1  401405008     希瑄彥         男           A   33.450
2           2  401550880     張泓丞         男           A   70.010
3           3  404550061     張安婕         女           A   67.995
4           4  404550042     柯政學         男           A   10.895
5           5  404550023     謝文躍         女           A   73.375
6           6  404550000     張樺玫         男           A   67.015
7           7  404550057     徐  敬         女           A   38.920
8           8  404550075     王亞詠         女           A   78.345
9           9  404550013     王承庭         男           A   48.525
10         10  404550001     高羽黛         女           A   20.455
11         11  404550189     丁易偉         女           A   96.435
12         12  404550177     彥氏丞         男           A   67.295
13         13  404550155     婕　學         女           A   16.150
14         14  404550143     躍庭祐         女           A   22.030
15         15  404550161     玫鈞霖         男           A   73.990
16         16  404550149     家聿穎         女           A   79.400
17         17  404550126     詠吾筑         男           A    8.560
18         18  404550294     庭馨儀         女           A   24.245
19         19  404550272     黛婕西         女           A   61.905
20         20  404550250     偉茹麥         男           A   61.340
21         21  404550238     氏存水         女           A   49.915
22         22  404550216     家芳榮         女           A   68.570
23         23  404550294     嫣玲杰         女           A   10.995
24         24  404550272     美慈蒙         女           A   67.055
25         25  404550250     鈺玲豪         男           A   68.000
26         26  404550215     宜  慈         男           A   69.210
27         27  404550287     柯陳渝         男           A   65.635
28         28  404550361     紀鍾暄         男           A   84.040
29         29  404550340     蔡鍾毅         男           A   66.100
30         30  404550328     梅林茹         男           A   78.540
31         31  404550386     王柯辰         女           A   75.330
32         32  404550360     曾紀崴         女           A   69.860
33         33  404550344     呂蔡嘉         男           A   72.240
34         34  404550322     廖繆傑         男           A   82.260
35         35  404550328     李梅祐         男           A   54.765
36         36  404550369     陳王霖         女           A   88.460
37         37  404550420     何瑄穎         男           A   30.205
38         38  404550431     沈泓霏         女           A   55.245
39         39  404550442     許安霏         女           A   77.920
40         40  404550453     李政宜         男           A   99.150
41          1  404550465     史文羽         男           B   94.030
42          2  404685071     鄭樺妤         男           B   97.060
43          3  404685084     張敬安         男           B   81.350
44          4  404685099     何筑亦         女           B   40.535
45          5  404685100     張  儀         女           B   55.375
46          6  401550816     雷西萱         男           B   62.355
47          7  401555528     張麥笙         女           B   61.310
48          8  403555042     張水兆         男           B   50.450
49          9  404720052     柯榮品         男           B   21.600
50         10  404720063     謝卡欣         男           B   36.700
51         11  404720074     張莉儷         男           B   32.150
52         12  404720005     王恭莞         女           B   76.810
53         13  404720016     王琇易         男           B   48.200
54         14  404720027     高凱瓊         男           B   52.550
55         15  404720038     丁乃愛         男           B   69.700
56         16  404720049     張瑞書         女           B   43.360
57         17  404720150     曾銘清         男           B   60.910
58         18  404720161     劉莞韋         男           B   94.070
59         19  404720172     曾易佳         男           B   77.990
60         20  404720184     黃瓊品         男           B   23.950
61         21  404720195     廖愛靜         男           B   39.100
62         22  404720106     詹書飛         男           B   80.600
63         23  404720117     劉徐卉         男           B   72.850
64         24  404720211     許怡怡         男           B   22.050
65         25  404720427     鄭  芊         男           B   47.200
66         26  404720526     楊亞易         女           B   20.800
67         27  404720624     張羽廖         男           B   61.550
68         28  404720722     楊佳聿         女           B   58.300
69         29  404720429     吾靜宜         男           B   40.800
70         30  404720527     馨飛羽         男           B   55.000
71         31  404720625     婕曾卉         男           B   26.280
72         32  404720723     茹呂怡         男           B   70.050
73         33  404720821     存廖芊         男           B   49.450
74         34  404720929     芳李米         男           B   62.900
75         35  404720037     勳  陳         男           B   54.960
76         36  404720135     萱何兆         男           B   74.900
77         37  404720231     笙沈品         男           B   71.360
78         38  404720338     倩許欣         男           B   67.800
79         39  404720436     曼李儷         女           B   85.140
80         40  404720534     雅清史         女           B   21.300
81         41  404720638     恭倩鄭         男           B   72.200
82         42  404720736     琇曼張         女           B   78.410
83         43  404720834     張雅益         女           B   82.300
84         44  404720932     曾林凱         女           B   51.510
85         45  404720040     劉杰乃         男           B   74.660
86         46  404720147     曾鈞瑞         女           B   45.200
87         47  404720245     黃品銘         男           B   65.300
88         48  404720343     廖林韋         男           B   87.220
89         49  404720541     詹傑仙         女           B  100.000
90         50  404685109     許  何         男           B   95.720
91         51  404685407     鄭鈺尤         女           B  100.000
92         52  404685905     楊宜路         男           B   72.590
93         53  404685013     張渝妤         男           B   44.460
94         54  404685119     廖暄安         男           B   70.000
95         55  499555916     楊毅亦         女           B   59.350
> 
> #(d) 列出學期成績在 55(含)∼60 分 (不含) 之間的所有同學之全部各欄位紀錄。
> subset(Score, 學期成績 >= 55 & 學期成績< 60)
   score.座號 score.學號 score.姓名 score.性別 score.Class 學期成績
38         38  404550431     沈泓霏         女           A   55.245
45          5  404685100     張  儀         女           B   55.375
68         28  404720722     楊佳聿         女           B   58.300
70         30  404720527     馨飛羽         男           B   55.000
95         55  499555916     楊毅亦         女           B   59.350
> 
> #(e) A、B 兩班總成績平均各為多少? 男、女生學期成績平均各為多少?
> A <- subset(Score,score$Class == "A")
> A.m <- mean(A$學期成績)
> A.m
[1] 58.84575
> 
> B <- subset(Score,score$Class == "B")
> B.m <- mean(B$學期成績)
> B.m
[1] 61.123
> 
> b <- subset(Score,score$性別 == "男")
> b.m <- mean(b$學期成績)
> b.m
[1] 60.90322
> 
> g <- subset(Score,score$性別 == "女")
> g.m <- mean(g$學期成績)
> g.m
[1] 58.95292
> 
> #(f) A 班學期成績不及格比例為多少? B 班男同學學期成績不及格比例為多少?
> library(plyr)
> count(A $學期成績 < 60)
      x freq
1 FALSE   26
2  TRUE   14
> Bb <- subset(Score,score$性別 == "男" & score$Class == "B")
> count(Bb $學期成績 < 60) 
      x freq
1 FALSE   23
2  TRUE   16
> boy.
錯誤: 找不到物件 'boy.'
> #(g) 分別印出男、女生學期成績前 5 名之「班別、學號、姓名、學期成績、名次」等欄位紀錄。
> #(男、女生各按照名次依序列出)
> score.b <- data.frame(head(b[order(b$學期成績, decreasing = TRUE),],5),1:5)
> colnames(score.b)[7] <- "名次"
> score.b
   score.座號 score.學號 score.姓名 score.性別 score.Class 學期成績 名次
40         40  404550453     李政宜         男           A    99.15    1
42          2  404685071     鄭樺妤         男           B    97.06    2
90         50  404685109     許  何         男           B    95.72    3
58         18  404720161     劉莞韋         男           B    94.07    4
41          1  404550465     史文羽         男           B    94.03    5
> 
> score.g <- data.frame(head(g[order(g$學期成績, decreasing = TRUE),],5),1:5)
> colnames(score.g)[7] <- "名次"
> score.g
   score.座號 score.學號 score.姓名 score.性別 score.Class 學期成績 名次
89         49  404720541     詹傑仙         女           B  100.000    1
91         51  404685407     鄭鈺尤         女           B  100.000    2
11         11  404550189     丁易偉         女           A   96.435    3
36         36  404550369     陳王霖         女           A   88.460    4
79         39  404720436     曼李儷         女           B   85.140    5
> 
> #2. 下列 Letters.code 為㇐個包含「A」∼「E」的向量。
> set.seed(123456)
> Letters.code <- sample(LETTERS[1:5], 20, replace=T)
> #(a) 將 Letters.code 中的「A」與「E」編碼為 1，「C」編碼為 2，「B」與「D」編碼為 3。
> table <- data.frame(Numbers=c(1,3,2,3,1))
> 
> #(b) 將上小題所得到的數字編碼 Numbers.code，與 Letters.code 組成㇐個資料框 (data.frame),
> #使其具有 Letters.code 和 Numbers.code 兩欄位。
> Numbers <- function(x){
+   Numbers.code <- ifelse(x == "A" , 1,
+                          ifelse(x == "E" , 1,
+                                 ifelse(x == "B" , 3,
+                                        ifelse(x == "D" , 3, 2))))
+   data.frame(Letters.code=x,Numbers.code, row.names = NULL) }
> Numbers(Letters.code)
   Letters.code Numbers.code
1             D            3
2             B            3
3             B            3
4             A            1
5             E            1
6             D            3
7             B            3
8             C            2
9             C            2
10            E            1
11            C            2
12            D            3
13            B            3
14            E            1
15            A            1
16            B            3
17            E            1
18            C            2
19            D            3
20            C            2